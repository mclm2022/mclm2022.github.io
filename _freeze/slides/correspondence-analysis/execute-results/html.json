{
  "hash": "2f2e8cf5288e6a8c6fad8ee96f5b6054",
  "result": {
    "markdown": "---\ntitle: \"Correspondence Analysis\"\nformat: revealjs\nexecute:\n  echo: true\n---\n\n\n## Correspondence Analysis\n\nDimension reduction technique for \"count\" data.\n\nVisualization: **biplot**, showing relationships:\n\n- between rows\n\n- between columns\n\n- between rows and columns.\n\n## Count data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(mclm)\ndata(smoke)\nsmoke\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   none light medium heavy\nSM    4     2      3     2\nJM    4     3      7     4\nSE   25    10     12     4\nJE   18    24     33    13\nSC   10     6      7     2\n```\n:::\n:::\n\n\n::: {.incremental}\n\n- Rows = staff category (Senior/Junior manager/employee, Secretary)\n\n- Columns = smoking category (from none to heavy)\n\n- Cells = **counts**, e.g. 4 of the senior managers don't smoke.\n\n:::\n\n## Biplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsmoke_ca <- ca(smoke)\nplot(smoke_ca)\n```\n\n::: {.cell-output-display}\n![](correspondence-analysis_files/figure-revealjs/plot1-1.png){width=960}\n:::\n:::\n\n\n# Terminology\n\n\n\n\n\n## Original matrix $N$\n\n:::: {.columns}\n\n::: {.column width=\"35%\"}\n$n \\times m$ matrix with frequency counts $n_{ij}$\n\n- $n$ = 5\n- $m$ = 4\n- $n_{\\mathrm{SE, light}}$ = 10\n\n:::\n\n::: {.column width=\"5%\"}\n:::\n\n::: {.column width=\"60%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nsmoke_mtx <- as.matrix(smoke)\nprint_matrix(smoke_mtx)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-size: 20px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> none </th>\n   <th style=\"text-align:right;\"> light </th>\n   <th style=\"text-align:right;\"> medium </th>\n   <th style=\"text-align:right;\"> heavy </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> SM </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JM </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SE </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JE </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:right;\"> 33 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SC </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n::::\n\n::: {.aside}\nCheck out the source code of the slides if you want to use `print_matrix()`.\n:::\n\n## Correspondence matrix $P$\n\n$n \\times m$ matrix with overall proportions $p_{ij}$\n\n:::: {.columns}\n\n::: {.column width=\"35%\"}\n\n### Mass\n\n- $p_{\\mathrm{(SE,light)}}$ = 0.0518\n\n- $p_{\\mathrm{SE}}$ = 0.264\n\n- $p_{\\mathrm{light}}$ = 0.233\n\n:::\n\n::: {.column width=\"5%\"}\n:::\n\n::: {.column width=\"60%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nprop.table(smoke_mtx) %>% \n  addmargins() %>% \n  print_matrix()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-size: 20px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> none </th>\n   <th style=\"text-align:right;\"> light </th>\n   <th style=\"text-align:right;\"> medium </th>\n   <th style=\"text-align:right;\"> heavy </th>\n   <th style=\"text-align:right;\"> Sum </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> SM </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.016 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.057 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JM </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;\"> 0.016 </td>\n   <td style=\"text-align:right;\"> 0.036 </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.093 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SE </td>\n   <td style=\"text-align:right;\"> 0.130 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.264 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JE </td>\n   <td style=\"text-align:right;\"> 0.093 </td>\n   <td style=\"text-align:right;\"> 0.124 </td>\n   <td style=\"text-align:right;\"> 0.171 </td>\n   <td style=\"text-align:right;\"> 0.067 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.456 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SC </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.031 </td>\n   <td style=\"text-align:right;\"> 0.036 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.130 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Sum </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.316 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.233 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.321 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.130 </td>\n   <td style=\"text-align:right;font-weight: bold;font-weight: bold;\"> 1.000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n::::\n\n## Row profiles matrix $R$\n\n:::: {.columns}\n\n::: {.column width=\"35%\"}\n$n \\times m$ matrix with overall row proportions $r_{ij}$\n\n- $r_{\\mathrm{SE,light}}$ = 0.196\n\n- columns are dimensions in the **row points cloud**\n\n:::\n\n::: {.column width=\"5%\"}\n:::\n\n::: {.column width=\"60%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nprop.table(smoke_mtx, 1) %>% \n  addmargins(1) %>% \n  print_matrix()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-size: 20px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> none </th>\n   <th style=\"text-align:right;\"> light </th>\n   <th style=\"text-align:right;\"> medium </th>\n   <th style=\"text-align:right;\"> heavy </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> SM </td>\n   <td style=\"text-align:right;\"> 0.364 </td>\n   <td style=\"text-align:right;\"> 0.182 </td>\n   <td style=\"text-align:right;\"> 0.273 </td>\n   <td style=\"text-align:right;\"> 0.182 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JM </td>\n   <td style=\"text-align:right;\"> 0.222 </td>\n   <td style=\"text-align:right;\"> 0.167 </td>\n   <td style=\"text-align:right;\"> 0.389 </td>\n   <td style=\"text-align:right;\"> 0.222 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SE </td>\n   <td style=\"text-align:right;\"> 0.490 </td>\n   <td style=\"text-align:right;\"> 0.196 </td>\n   <td style=\"text-align:right;\"> 0.235 </td>\n   <td style=\"text-align:right;\"> 0.078 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JE </td>\n   <td style=\"text-align:right;\"> 0.205 </td>\n   <td style=\"text-align:right;\"> 0.273 </td>\n   <td style=\"text-align:right;\"> 0.375 </td>\n   <td style=\"text-align:right;\"> 0.148 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SC </td>\n   <td style=\"text-align:right;\"> 0.400 </td>\n   <td style=\"text-align:right;\"> 0.240 </td>\n   <td style=\"text-align:right;\"> 0.280 </td>\n   <td style=\"text-align:right;\"> 0.080 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Sum </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 1.681 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 1.057 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 1.552 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.710 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n::::\n\n## Column profiles matrix $C$\n\n:::: {.columns}\n\n::: {.column width=\"35%\"}\n$n \\times m$ matrix with overall column proportions $c_{ij}$\n\n- $c_{\\mathrm{(SE,light)}}$ = 0.222\n\n- rows are dimensions in the **column points cloud**\n\n:::\n\n::: {.column width=\"5%\"}\n:::\n\n::: {.column width=\"60%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nprop.table(smoke_mtx, 2) %>% \n  addmargins(2) %>% \n  print_matrix()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-size: 20px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> none </th>\n   <th style=\"text-align:right;\"> light </th>\n   <th style=\"text-align:right;\"> medium </th>\n   <th style=\"text-align:right;\"> heavy </th>\n   <th style=\"text-align:right;\"> Sum </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> SM </td>\n   <td style=\"text-align:right;\"> 0.066 </td>\n   <td style=\"text-align:right;\"> 0.044 </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.238 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JM </td>\n   <td style=\"text-align:right;\"> 0.066 </td>\n   <td style=\"text-align:right;\"> 0.067 </td>\n   <td style=\"text-align:right;\"> 0.113 </td>\n   <td style=\"text-align:right;\"> 0.16 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.405 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SE </td>\n   <td style=\"text-align:right;\"> 0.410 </td>\n   <td style=\"text-align:right;\"> 0.222 </td>\n   <td style=\"text-align:right;\"> 0.194 </td>\n   <td style=\"text-align:right;\"> 0.16 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JE </td>\n   <td style=\"text-align:right;\"> 0.295 </td>\n   <td style=\"text-align:right;\"> 0.533 </td>\n   <td style=\"text-align:right;\"> 0.532 </td>\n   <td style=\"text-align:right;\"> 0.52 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 1.881 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SC </td>\n   <td style=\"text-align:right;\"> 0.164 </td>\n   <td style=\"text-align:right;\"> 0.133 </td>\n   <td style=\"text-align:right;\"> 0.113 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.490 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n::::\n\n## Chi-squared distances {.smaller}\n\n- Euclidean distance\n\n$$\\sqrt{\\sum_{j=1}^m(r_{ij}-r_{i'j})^2}$$\n\n- Chi-squared distance - it divides by the mass of the row/columns^[It corrects for the fact that the more data you have, the more variability you can expect.]\n\n$$\\sqrt{\\sum_{j=1}^m\\frac{(r_{ij}-r_{i'j})^2}{p_{.j}}}$$\n\n## Inertia\n\nSum of the squares of the residuals.\n\nThe cell contribution of cell $ij$ = $\\frac{(p_{ij}-(p_{i.} \\times p_{.j}))^2}{p_i\\times p_{.j}}$\n\n:::: {.columns}\n\n::: {.column}\n\n::: {.cell}\n\n```{.r .cell-code}\naddmargins(smoke_mtx) %>% \n  print_matrix\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-size: 20px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> none </th>\n   <th style=\"text-align:right;\"> light </th>\n   <th style=\"text-align:right;\"> medium </th>\n   <th style=\"text-align:right;\"> heavy </th>\n   <th style=\"text-align:right;\"> Sum </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> SM </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JM </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SE </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 51 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JE </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:right;\"> 33 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SC </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 25 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Sum </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 61 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 45 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 62 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 25 </td>\n   <td style=\"text-align:right;font-weight: bold;font-weight: bold;\"> 193 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n::: {.column .incremental .smaller}\n\n...for cell [\"SE\", \"none\"]\n\n\n\n\n\n- $p_{ij} = \\frac{4}{193} = 0.0207254$\n\n- $p_{i.} = \\frac{11}{193} = 0.0569948$\n\n- $p_{.j} = \\frac{61}{193} = 0.3160622$\n\n- $p_{i.} \\times p_{.j} = \\frac{11}{193} \\times \\frac{61}{193} = 3.477$\n\n:::\n\n::::\n\n## Inertia\n\nSum of the squares of the residuals.\n\nThe cell contribution of cell $ij$ = $\\frac{(p_{ij}-(p_{i.} \\times p_{.j}))^2}{p_i\\times p_{.j}}$\n\n:::: {.columns}\n\n::: {.column}\n\n::: {.cell}\n\n```{.r .cell-code}\nprop.table(smoke_mtx) %>% \n  addmargins() %>% \n  print_matrix\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-size: 20px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> none </th>\n   <th style=\"text-align:right;\"> light </th>\n   <th style=\"text-align:right;\"> medium </th>\n   <th style=\"text-align:right;\"> heavy </th>\n   <th style=\"text-align:right;\"> Sum </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> SM </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.016 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.057 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JM </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;\"> 0.016 </td>\n   <td style=\"text-align:right;\"> 0.036 </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.093 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SE </td>\n   <td style=\"text-align:right;\"> 0.130 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.264 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JE </td>\n   <td style=\"text-align:right;\"> 0.093 </td>\n   <td style=\"text-align:right;\"> 0.124 </td>\n   <td style=\"text-align:right;\"> 0.171 </td>\n   <td style=\"text-align:right;\"> 0.067 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.456 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SC </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.031 </td>\n   <td style=\"text-align:right;\"> 0.036 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.130 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Sum </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.316 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.233 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.321 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 0.130 </td>\n   <td style=\"text-align:right;font-weight: bold;font-weight: bold;\"> 1.000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n::: {.column .incremental .smaller}\n\n...for cell [\"SE\", \"none\"]\n\n<!-- TODO THINK ABOUT THIS -->\n\n\n\n\n\n- $\\frac{(p_{ij}-(p_{i.} \\times p_{.j}))^2}{p_i\\times p_{.j}}$\n\n- $\\frac{(0.0207254-(0.057 \\times 0.316))^2}{0.057 \\times 0.316}$\n\n- $\\frac{(0.0207254-0.018)^2}{0.018} = 4\\times 10^{-4}$\n\n:::\n\n::::\n\n## Computing $\\chi^2$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsmoke_chisq <- chisq.test(smoke)\nsmoke_chisq\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test\n\ndata:  smoke\nX-squared = 16.442, df = 12, p-value = 0.1718\n```\n:::\n:::\n\n\n:::: {.columns}\n\n::: {.column}\n\n::: {.cell}\n\n```{.r .cell-code}\nsmoke_chisq$expected %>% print_matrix()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-size: 20px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> none </th>\n   <th style=\"text-align:right;\"> light </th>\n   <th style=\"text-align:right;\"> medium </th>\n   <th style=\"text-align:right;\"> heavy </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> SM </td>\n   <td style=\"text-align:right;\"> 3.477 </td>\n   <td style=\"text-align:right;\"> 2.565 </td>\n   <td style=\"text-align:right;\"> 3.534 </td>\n   <td style=\"text-align:right;\"> 1.425 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JM </td>\n   <td style=\"text-align:right;\"> 5.689 </td>\n   <td style=\"text-align:right;\"> 4.197 </td>\n   <td style=\"text-align:right;\"> 5.782 </td>\n   <td style=\"text-align:right;\"> 2.332 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SE </td>\n   <td style=\"text-align:right;\"> 16.119 </td>\n   <td style=\"text-align:right;\"> 11.891 </td>\n   <td style=\"text-align:right;\"> 16.383 </td>\n   <td style=\"text-align:right;\"> 6.606 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JE </td>\n   <td style=\"text-align:right;\"> 27.813 </td>\n   <td style=\"text-align:right;\"> 20.518 </td>\n   <td style=\"text-align:right;\"> 28.269 </td>\n   <td style=\"text-align:right;\"> 11.399 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SC </td>\n   <td style=\"text-align:right;\"> 7.902 </td>\n   <td style=\"text-align:right;\"> 5.829 </td>\n   <td style=\"text-align:right;\"> 8.031 </td>\n   <td style=\"text-align:right;\"> 3.238 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n:::\n\n::: {.column}\n\n::: {.cell}\n\n```{.r .cell-code}\nsmoke_chisq$residuals %>% print_matrix()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-size: 20px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> none </th>\n   <th style=\"text-align:right;\"> light </th>\n   <th style=\"text-align:right;\"> medium </th>\n   <th style=\"text-align:right;\"> heavy </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> SM </td>\n   <td style=\"text-align:right;\"> 0.281 </td>\n   <td style=\"text-align:right;\"> -0.353 </td>\n   <td style=\"text-align:right;\"> -0.284 </td>\n   <td style=\"text-align:right;\"> 0.482 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JM </td>\n   <td style=\"text-align:right;\"> -0.708 </td>\n   <td style=\"text-align:right;\"> -0.584 </td>\n   <td style=\"text-align:right;\"> 0.506 </td>\n   <td style=\"text-align:right;\"> 1.093 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SE </td>\n   <td style=\"text-align:right;\"> 2.212 </td>\n   <td style=\"text-align:right;\"> -0.548 </td>\n   <td style=\"text-align:right;\"> -1.083 </td>\n   <td style=\"text-align:right;\"> -1.014 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JE </td>\n   <td style=\"text-align:right;\"> -1.861 </td>\n   <td style=\"text-align:right;\"> 0.769 </td>\n   <td style=\"text-align:right;\"> 0.890 </td>\n   <td style=\"text-align:right;\"> 0.474 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SC </td>\n   <td style=\"text-align:right;\"> 0.747 </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n   <td style=\"text-align:right;\"> -0.364 </td>\n   <td style=\"text-align:right;\"> -0.688 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n:::\n\n::::\n\n\n## Inertia of a row\n\n...the sum of the cell contributions to the inertia of all cells of a row\n\n- the row mass $p_{i.}$ multiplied by the square of the row distance to the centroid of the row points cloud\n\n(Same for the columns)",
    "supporting": [
      "correspondence-analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ],
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n\r\n      // dispatch for htmlwidgets\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for reveal\r\n    if (window.Reveal) {\r\n      window.Reveal.addEventListener(\"slidechanged\", function(event) {\r\n        fireSlideChanged(event.previousSlide, event.currentSlide);\r\n      });\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}