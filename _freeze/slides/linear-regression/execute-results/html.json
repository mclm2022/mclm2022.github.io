{
  "hash": "a45405e7c8231c86f4bd3f2d99a7c301",
  "result": {
    "markdown": "---\ntitle: \"Linear regression analysis\"\nsubtitle: \"Methods of Corpus Linguistics (class 5)\"\nauthor: \"Mariana Montes\"\nformat:\n  revealjs:\n    preview-links: auto\n    multiplex: true\n    chalkboard:\n        buttons: false\n    code-fold: true\n    css: styles.css\nexecute:\n  echo: true\n---\n\n\n\n\n## Outline\n\n\n- Simple linear regression \n- Multiple linear regression \n- Categorical predictors \n- Easystats \n\n\n# Simple linear regression\n\n## Set up code\n\nIn case you want to run this by yourself...\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(tidyverse)\nlibrary(kableExtra)\nset.seed(2022)\n\nutt_lengths <- tibble(age = 3:17) %>% \n  mutate(utterance_length = 3 + 0.5*age + rnorm(n(), sd = 0.3))\nm1 <- lm(utterance_length ~ age, data = utt_lengths)\nutt_lengths$fit <- m1$fitted.values\n```\n:::\n\n\n::: {.footer}\nSimple linear regression\n:::\n\n## Scatterplot\n\nWhat is the relationship between the age of a child and the mean length of their utterances (in a corpus)?\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-fold=\"false\"}\ng <- ggplot(utt_lengths, aes(\n  x = age,\n  y = utterance_length\n  )) +\n  geom_point(size = 3) +\n  labs(x = \"Age\",\n       y = \"Utterance length\") +\n  xlim(0,18) + ylim(0,15) +\n  theme_minimal(base_size = 20) +\n  theme(aspect.ratio = 1)\ng\n```\n\n::: {.cell-output-display}\n![](linear-regression_files/figure-revealjs/linear-points-1.png){width=960}\n:::\n:::\n\n\n::: {.footer}\nSimple linear regression\n:::\n\n## Intercept\n\nThe average utterance length is 7.885:\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-fold=\"false\"}\ng_int <- g +\n  geom_hline(\n    aes(\n      yintercept = mean(utterance_length)\n      ),\n    linetype = 2,\n    color = \"coral\",\n    size = 1\n    )\ng_int\n```\n\n::: {.cell-output-display}\n![](linear-regression_files/figure-revealjs/linear-mean-1.png){width=960}\n:::\n:::\n\n\n::: {.footer}\nSimple linear regression\n:::\n\n## Fitted model\n\nBut we try to find a line that fits the trend the best:\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-fold=\"false\"}\ng_fit <- g +\n  geom_abline(\n    intercept = m1$coefficients[[1]],\n    slope = m1$coefficients[[2]],\n    linetype = 2,\n    color = \"darkcyan\",\n    size = 1\n    )\ng_fit\n```\n\n::: {.cell-output-display}\n![](linear-regression_files/figure-revealjs/linear-line-1.png){width=960}\n:::\n:::\n\n::: {.footer}\nSimple linear regression\n:::\n\n## Error\n\n:::: {.columns incremental=true}\n\n::: {.column width=\"50%\"}\n### Sum of squares total\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng_int +\n  geom_segment(aes(xend = age, yend = mean(utterance_length)), color = \"coral3\", size = 2)\n```\n\n::: {.cell-output-display}\n![](linear-regression_files/figure-revealjs/sst-1.png){width=960}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n### Sum of squares error\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng_fit +\n  geom_segment(aes(xend = age, yend = fit), color = \"cyan4\", size = 2)\n```\n\n::: {.cell-output-display}\n![](linear-regression_files/figure-revealjs/sse-1.png){width=960}\n:::\n:::\n\n\n:::\n\n::::\n\n::: {.footer}\nSimple linear regression\n:::\n\n## Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nutt_lengths %>% mutate(intercept = mean(utterance_length)) %>%\n  slice_sample(n = 7) %>% kb_style()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-size: 22px; font-family: \"Arial Narrow\", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> age </th>\n   <th style=\"text-align:right;\"> utterance_length </th>\n   <th style=\"text-align:right;\"> fit </th>\n   <th style=\"text-align:right;\"> intercept </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 11.48 </td>\n   <td style=\"text-align:right;\"> 11.52 </td>\n   <td style=\"text-align:right;\"> 7.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 9.94 </td>\n   <td style=\"text-align:right;\"> 9.96 </td>\n   <td style=\"text-align:right;\"> 7.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 11.03 </td>\n   <td style=\"text-align:right;\"> 11.00 </td>\n   <td style=\"text-align:right;\"> 7.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 6.13 </td>\n   <td style=\"text-align:right;\"> 6.85 </td>\n   <td style=\"text-align:right;\"> 7.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 7.18 </td>\n   <td style=\"text-align:right;\"> 7.37 </td>\n   <td style=\"text-align:right;\"> 7.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 10.21 </td>\n   <td style=\"text-align:right;\"> 10.48 </td>\n   <td style=\"text-align:right;\"> 7.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 6.40 </td>\n   <td style=\"text-align:right;\"> 6.33 </td>\n   <td style=\"text-align:right;\"> 7.88 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.footer}\nSimple linear regression\n:::\n\n## `lm()` output {chalkboard-buttons=\"true\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = utterance_length ~ age, data = utt_lengths)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-0.717 -0.154 -0.016  0.174  0.518 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   2.6958     0.2036    13.2  6.3e-09 ***\nage           0.5189     0.0187    27.8  5.8e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.313 on 13 degrees of freedom\nMultiple R-squared:  0.983,\tAdjusted R-squared:  0.982 \nF-statistic:  771 on 1 and 13 DF,  p-value: 5.84e-13\n```\n:::\n:::\n\n\n::: {.footer}\nSimple linear regression\n:::\n\n## Simple linear regression\n\nSimple\n\n:   one predictor variable\n\nLinear\n\n:   linear relation between estimated parameters and response variable\n\nNotation\n\n:   `y ~ x`\n\nEstimation: OSL\n\n:   Ordinary least squares, minimizing sum of squares of residuals\n\n::: {.footer}\nSimple linear regression\n:::\n\n\n\n\n\n# Multiple linear regression\n\n## Add a predictor\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nset.seed(7)\nutt_lengths <- utt_lengths %>% \n  mutate(pages_read = n()/2 + rnorm(n(), mean = 6, sd = 3))\n\nm2 <- lm(utterance_length ~ age + pages_read, data = utt_lengths)\nutt_lengths$fit2 <- m2$fitted.values\n\nutt_lengths %>% slice_tail(n = 7) %>% kb_style()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-size: 22px; font-family: \"Arial Narrow\", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> age </th>\n   <th style=\"text-align:right;\"> utterance_length </th>\n   <th style=\"text-align:right;\"> fit </th>\n   <th style=\"text-align:right;\"> pages_read </th>\n   <th style=\"text-align:right;\"> fit2 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 8.72 </td>\n   <td style=\"text-align:right;\"> 8.40 </td>\n   <td style=\"text-align:right;\"> 14.0 </td>\n   <td style=\"text-align:right;\"> 8.35 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 9.07 </td>\n   <td style=\"text-align:right;\"> 8.92 </td>\n   <td style=\"text-align:right;\"> 20.1 </td>\n   <td style=\"text-align:right;\"> 9.04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 9.80 </td>\n   <td style=\"text-align:right;\"> 9.44 </td>\n   <td style=\"text-align:right;\"> 14.6 </td>\n   <td style=\"text-align:right;\"> 9.38 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 9.94 </td>\n   <td style=\"text-align:right;\"> 9.96 </td>\n   <td style=\"text-align:right;\"> 21.6 </td>\n   <td style=\"text-align:right;\"> 10.10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 10.21 </td>\n   <td style=\"text-align:right;\"> 10.48 </td>\n   <td style=\"text-align:right;\"> 20.3 </td>\n   <td style=\"text-align:right;\"> 10.56 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 11.03 </td>\n   <td style=\"text-align:right;\"> 11.00 </td>\n   <td style=\"text-align:right;\"> 14.5 </td>\n   <td style=\"text-align:right;\"> 10.89 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 11.48 </td>\n   <td style=\"text-align:right;\"> 11.52 </td>\n   <td style=\"text-align:right;\"> 19.2 </td>\n   <td style=\"text-align:right;\"> 11.54 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.footer}\nMultiple linear regression\n:::\n\n## Scatterplot and fitted model\n\n\n\n\n```{ojs}\n//| echo: false\nplt = require(\"https://cdn.plot.ly/plotly-latest.min.js\")\npoints = [{x: data.age, y: data.pages_read, z: data.utterance_length,\ntype: \"scatter3d\", mode: \"markers\", hovertemplate: '<b>Age</b>: %{x}' + '<br><b>UT</b>: %{z:.2f}<br>' +  '<b>PR</b>: %{y:.2f}'}]\nsurface = [{x: data.age, y: data.pages_read, z: surface_fit,\ntype: \"surface\", showscale: false}]\n```\n\n```{ojs}\n//| panel: input\n//| echo: false\nviewof traces = Inputs.checkbox(\n  [\n    {value: points[0], label: \"Observed values\"},\n    {value: surface[0], label: \"Fitted plane\"}\n  ],\n  {\n    value: [points[0]],\n    label: \"Show:\",\n    format: (d) => d.label,\n    valueof: (d) => d.value\n  }\n)\n```\n\n```{ojs}\n//| echo: false\nplt.newPlot(DOM.element(\"div\"), traces, layout)\n```\n\n\n::: {.footer}\nMultiple linear regression\n:::\n\n## Model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = utterance_length ~ age + pages_read, data = utt_lengths)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-0.6100 -0.1804 -0.0159  0.2139  0.4207 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   2.3841     0.3157    7.55  6.7e-06 ***\nage           0.5052     0.0212   23.82  1.8e-11 ***\npages_read    0.0295     0.0232    1.27     0.23    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.306 on 12 degrees of freedom\nMultiple R-squared:  0.985,\tAdjusted R-squared:  0.983 \nF-statistic:  405 on 2 and 12 DF,  p-value: 9.72e-12\n```\n:::\n:::\n\n\n::: {.footer}\nMultiple linear regression\n:::\n\n## Multiple linear regression\n\nMultiple\n\n:   more than one predictor\n\nNotation\n\n:   `y ~ x1 + x2` (fitting on a plane)\n\n:   `y ~ x1 + x2 + ... + xn` (fitting on a hyperplane)\n\nEstimation: OSL\n\n:   Ordinary least squares, minimizing sum of squares of residuals\n\n::: {.footer}\nMultiple linear regression\n:::\n\n\n\n\n\n# Categorical predictors\n\n## Two levels\n\n-   E.g. \"monolingual family\": yes/no\n\n-   Translated into 1 **dummy** predictor with two levels\n\n    -   0: reference level, e.g. *no*\n\n    -   1: other level, e.g. *yes*\n\n-   Line fitted between 0 and 1, slope is the difference in `y` when *yes* (compared to *no*)\n\n::: {.footer}\nCategorical predictors\n:::\n\n## Two levels: example {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nutt_lengths_cat <- utt_lengths %>% mutate(mono = factor(c(rep(\"no\", 5), \"yes\", \"no\", \"no\", rep(\"yes\", 7))))\n```\n:::\n\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(utt_lengths_cat, aes(x = as.numeric(mono)-1, y = utterance_length)) +\n  geom_point(size = 3) + geom_smooth(method = \"lm\", se = FALSE, color = \"darkolivegreen4\") +\n  labs(x = \"Is the family monolingual?\", y = \"Utterance length\") +\n  ylim(c(0,15)) + scale_x_continuous(breaks = c(0, 1), labels = c(\"no\", \"yes\")) +\n  theme_minimal(base_size = 20) + theme(aspect.ratio = 1)\n```\n\n::: {.cell-output-display}\n![](linear-regression_files/figure-revealjs/mono-plot-1.png){width=960}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(utterance_length ~ mono, data = utt_lengths_cat))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = utterance_length ~ mono, data = utt_lengths_cat)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-3.419 -0.788  0.253  0.928  2.100 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    5.983      0.566    10.6  9.5e-08 ***\nmonoyes        3.566      0.776     4.6    5e-04 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.5 on 13 degrees of freedom\nMultiple R-squared:  0.619,\tAdjusted R-squared:  0.59 \nF-statistic: 21.1 on 1 and 13 DF,  p-value: 5e-04\n```\n:::\n:::\n\n\n:::\n\n::::\n\n::: {.footer}\nCategorical predictors\n:::\n\n## More than two levels\n\n-   E.g. \"L1\": EN, ES, FR...\n\n-   Translated into *n*-1 **dummy** predictors with two levels\n\n    -   1: one of the levels, not the reference level, e.g. Es\n\n    -   0: the rest of the levels, including the reference level (e.g. EN)\n\n-   (Hyper)plane fitted between combinations of 0 and 1, slope is the difference in `y` when compared to the reference level.\n\n::: {.footer}\nCategorical predictors\n:::\n\n## Data: categorical predictors\n\n\n::: {.cell layout-ncol=\"3\"}\n\n```{.r .cell-code  code-fold=\"false\"}\nmean_utts <- c(EN = 11, ES = 7.4, ZH = 7.8)\nset.seed(2022)\nby_lang <- tibble(L1 = factor(rep(c(\"EN\", \"ES\", \"ZH\"), 15))) %>% \n  mutate(utterance_length = rnorm(n(), mean = mean_utts[L1], sd = 0.8))\nkb_style(filter(by_lang, L1 == \"EN\"), \"float_left\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-size: 22px; font-family: \"Arial Narrow\", arial, helvetica, sans-serif; width: auto !important; float: left; margin-right: 10px;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> L1 </th>\n   <th style=\"text-align:right;\"> utterance_length </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> EN </td>\n   <td style=\"text-align:right;\"> 11.72 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EN </td>\n   <td style=\"text-align:right;\"> 9.84 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EN </td>\n   <td style=\"text-align:right;\"> 10.15 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EN </td>\n   <td style=\"text-align:right;\"> 11.19 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EN </td>\n   <td style=\"text-align:right;\"> 10.21 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EN </td>\n   <td style=\"text-align:right;\"> 10.94 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EN </td>\n   <td style=\"text-align:right;\"> 11.82 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EN </td>\n   <td style=\"text-align:right;\"> 11.31 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EN </td>\n   <td style=\"text-align:right;\"> 10.72 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EN </td>\n   <td style=\"text-align:right;\"> 11.26 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nkb_style(filter(by_lang, L1 == \"ES\"), \"float_left\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-size: 22px; font-family: \"Arial Narrow\", arial, helvetica, sans-serif; width: auto !important; float: left; margin-right: 10px;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> L1 </th>\n   <th style=\"text-align:right;\"> utterance_length </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> ES </td>\n   <td style=\"text-align:right;\"> 6.46 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ES </td>\n   <td style=\"text-align:right;\"> 7.13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ES </td>\n   <td style=\"text-align:right;\"> 7.62 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ES </td>\n   <td style=\"text-align:right;\"> 8.21 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ES </td>\n   <td style=\"text-align:right;\"> 7.47 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ES </td>\n   <td style=\"text-align:right;\"> 6.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ES </td>\n   <td style=\"text-align:right;\"> 8.09 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ES </td>\n   <td style=\"text-align:right;\"> 8.29 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ES </td>\n   <td style=\"text-align:right;\"> 6.71 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ES </td>\n   <td style=\"text-align:right;\"> 6.99 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nkb_style(filter(by_lang, L1 == \"ZH\"), \"left\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-size: 22px; font-family: \"Arial Narrow\", arial, helvetica, sans-serif; width: auto !important; '>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> L1 </th>\n   <th style=\"text-align:right;\"> utterance_length </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> ZH </td>\n   <td style=\"text-align:right;\"> 7.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ZH </td>\n   <td style=\"text-align:right;\"> 5.48 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ZH </td>\n   <td style=\"text-align:right;\"> 8.40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ZH </td>\n   <td style=\"text-align:right;\"> 7.65 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ZH </td>\n   <td style=\"text-align:right;\"> 7.76 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ZH </td>\n   <td style=\"text-align:right;\"> 7.04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ZH </td>\n   <td style=\"text-align:right;\"> 8.09 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ZH </td>\n   <td style=\"text-align:right;\"> 8.77 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ZH </td>\n   <td style=\"text-align:right;\"> 8.32 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ZH </td>\n   <td style=\"text-align:right;\"> 7.61 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.footer}\nCategorical predictors\n:::\n\n## Model with categorical predictors {.smaller}\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nm_lang1 <- lm(utterance_length ~ L1, data = by_lang)\nsummary(m_lang1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = utterance_length ~ L1, data = by_lang)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.2294 -0.5615  0.0488  0.6111  1.0603 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   10.928      0.189    57.9  < 2e-16 ***\nL1ES          -3.620      0.267   -13.6  < 2e-16 ***\nL1ZH          -3.219      0.267   -12.1  3.1e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.731 on 42 degrees of freedom\nMultiple R-squared:  0.84,\tAdjusted R-squared:  0.833 \nF-statistic:  111 on 2 and 42 DF,  p-value: <2e-16\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nes_first <- mutate(by_lang, L1 = fct_relevel(L1, \"ES\"))\nm_lang2 <- lm(utterance_length ~ L1, data = es_first)\nsummary(m_lang2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = utterance_length ~ L1, data = es_first)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.2294 -0.5615  0.0488  0.6111  1.0603 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    7.308      0.189    38.7   <2e-16 ***\nL1EN           3.620      0.267    13.6   <2e-16 ***\nL1ZH           0.401      0.267     1.5     0.14    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.731 on 42 degrees of freedom\nMultiple R-squared:  0.84,\tAdjusted R-squared:  0.833 \nF-statistic:  111 on 2 and 42 DF,  p-value: <2e-16\n```\n:::\n:::\n\n:::\n\n::::\n\n::: {.footer}\nCategorical predictors\n:::\n\n## Categorical predictors\n\n-   Comparison is done between each level and the reference level, not in all combinations\n\n-   t-test: does the slope of an individual dummy predictor differ from 0?\n\n-   F-test of nested models: do the dummy predictors jointly reduce unexplained variation?\n\n::: {.footer}\nCategorical predictors\n:::\n\n\n\n\n\n# Easystats\n\n## {report} package {.smaller}\n\n::: {.panel-tabset}\n\n### Simple\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreport(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWe fitted a linear model (estimated using OLS) to predict utterance_length with\nage (formula: utterance_length ~ age). The model explains a statistically\nsignificant and substantial proportion of variance (R2 = 0.98, F(1, 13) =\n771.19, p < .001, adj. R2 = 0.98). The model's intercept, corresponding to age\n= 0, is at 2.70 (95% CI [2.26, 3.14], t(13) = 13.24, p < .001). Within this\nmodel:\n\n  - The effect of age is statistically significant and positive (beta = 0.52, 95%\nCI [0.48, 0.56], t(13) = 27.77, p < .001; Std. beta = 0.99, 95% CI [0.91,\n1.07])\n\nStandardized parameters were obtained by fitting the model on a standardized\nversion of the dataset. 95% Confidence Intervals (CIs) and p-values were\ncomputed using a Wald t-distribution approximation.\n```\n:::\n:::\n\n\n### Multiple\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreport(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWe fitted a linear model (estimated using OLS) to predict utterance_length with\nage (formula: utterance_length ~ age + pages_read). The model explains a\nstatistically significant and substantial proportion of variance (R2 = 0.99,\nF(2, 12) = 404.69, p < .001, adj. R2 = 0.98). The model's intercept,\ncorresponding to age = 0, is at 2.38 (95% CI [1.70, 3.07], t(12) = 7.55, p <\n.001). Within this model:\n\n  - The effect of age is statistically significant and positive (beta = 0.51, 95%\nCI [0.46, 0.55], t(12) = 23.82, p < .001; Std. beta = 0.97, 95% CI [0.88,\n1.05])\n  - The effect of pages read is statistically non-significant and positive (beta\n= 0.03, 95% CI [-0.02, 0.08], t(12) = 1.27, p = 0.228; Std. beta = 0.05, 95% CI\n[-0.04, 0.14])\n\nStandardized parameters were obtained by fitting the model on a standardized\nversion of the dataset. 95% Confidence Intervals (CIs) and p-values were\ncomputed using a Wald t-distribution approximation. and We fitted a linear\nmodel (estimated using OLS) to predict utterance_length with pages_read\n(formula: utterance_length ~ age + pages_read). The model explains a\nstatistically significant and substantial proportion of variance (R2 = 0.99,\nF(2, 12) = 404.69, p < .001, adj. R2 = 0.98). The model's intercept,\ncorresponding to pages_read = 0, is at 2.38 (95% CI [1.70, 3.07], t(12) = 7.55,\np < .001). Within this model:\n\n  - The effect of age is statistically significant and positive (beta = 0.51, 95%\nCI [0.46, 0.55], t(12) = 23.82, p < .001; Std. beta = 0.97, 95% CI [0.88,\n1.05])\n  - The effect of pages read is statistically non-significant and positive (beta\n= 0.03, 95% CI [-0.02, 0.08], t(12) = 1.27, p = 0.228; Std. beta = 0.05, 95% CI\n[-0.04, 0.14])\n\nStandardized parameters were obtained by fitting the model on a standardized\nversion of the dataset. 95% Confidence Intervals (CIs) and p-values were\ncomputed using a Wald t-distribution approximation.\n```\n:::\n:::\n\n\n:::\n\n::: {.footer}\nEasystats\n:::\n\n## {parameters} package {.smaller}\n\n::: {.panel-tabset}\n\n### Simple\n\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nprint_md(model_parameters(m1))\n```\n\n::: {.cell-output-display}\n|Parameter   | Coefficient |   SE |       95% CI | t(13) |      p |\n|:-----------|:-----------:|:----:|:------------:|:-----:|:------:|\n|(Intercept) |        2.70 | 0.20 | (2.26, 3.14) | 13.24 | < .001 |\n|age         |        0.52 | 0.02 | (0.48, 0.56) | 27.77 | < .001 |\n:::\n\n```{.r .cell-code}\nplot(model_parameters(m1))\n```\n\n::: {.cell-output-display}\n![](linear-regression_files/figure-revealjs/parameters-1-1.png){width=960}\n:::\n:::\n\n\n### Multiple\n\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nprint_md(model_parameters(m2))\n```\n\n::: {.cell-output-display}\n|Parameter   | Coefficient |   SE |        95% CI | t(12) |      p |\n|:-----------|:-----------:|:----:|:-------------:|:-----:|:------:|\n|(Intercept) |        2.38 | 0.32 |  (1.70, 3.07) |  7.55 | < .001 |\n|age         |        0.51 | 0.02 |  (0.46, 0.55) | 23.82 | < .001 |\n|pages read  |        0.03 | 0.02 | (-0.02, 0.08) |  1.27 | 0.228  |\n:::\n\n```{.r .cell-code}\nplot(model_parameters(m2))\n```\n\n::: {.cell-output-display}\n![](linear-regression_files/figure-revealjs/parameters-2-1.png){width=960}\n:::\n:::\n\n\n### Comparison\n\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nprint_md(compare_parameters(m1, m2))\n```\n\n::: {.cell-output-display}\n|Parameter    |               m1 |                 m2|\n|:------------|:-----------------|------------------:|\n|(Intercept)  |2.70 (2.26, 3.14) |  2.38 (1.70, 3.07)|\n|age          |0.52 (0.48, 0.56) |  0.51 (0.46, 0.55)|\n|pages read   |                  | 0.03 (-0.02, 0.08)|\n|             |                  |                   |\n|Observations |               15 |                 15|\n:::\n\n```{.r .cell-code}\nplot(compare_parameters(m1, m2))\n```\n\n::: {.cell-output-display}\n![](linear-regression_files/figure-revealjs/parameters-4-1.png){width=960}\n:::\n:::\n\n\n:::\n\n::: {.footer}\nEasystats\n:::\n\n## {performance} package I {.smaller}\n\n::: {.panel-tabset}\n\n### Simple\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint_md(model_performance(m1))\n```\n\n::: {.cell-output-display}\nTable: Indices of model performance\n\n|AIC   |   BIC |   R2 | R2 (adj.) | RMSE | Sigma |\n|:-----|:-----:|:----:|:---------:|:----:|:-----:|\n|11.54 | 13.67 | 0.98 |      0.98 | 0.29 |  0.31 |\n:::\n:::\n\n\n### Multiple\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint_md(model_performance(m2))\n```\n\n::: {.cell-output-display}\nTable: Indices of model performance\n\n|AIC   |   BIC |   R2 | R2 (adj.) | RMSE | Sigma |\n|:-----|:-----:|:----:|:---------:|:----:|:-----:|\n|11.65 | 14.48 | 0.99 |      0.98 | 0.27 |  0.31 |\n:::\n:::\n\n\n### Comparison\n\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nm_perf <- compare_performance(m1, m2)\nprint_md(m_perf)\n```\n\n::: {.cell-output-display}\nTable: Comparison of Model Performance Indices\n\n|Name | Model | AIC (weights) | BIC (weights) |   R2 | R2 (adj.) | RMSE | Sigma |\n|:----|:-----:|:-------------:|:-------------:|:----:|:---------:|:----:|:-----:|\n|m1   |    lm |   11.5 (0.51) |   13.7 (0.60) | 0.98 |      0.98 | 0.29 |  0.31 |\n|m2   |    lm |   11.6 (0.49) |   14.5 (0.40) | 0.99 |      0.98 | 0.27 |  0.31 |\n:::\n\n```{.r .cell-code}\nplot(m_perf)\n```\n\n::: {.cell-output-display}\n![](linear-regression_files/figure-revealjs/performance-4-1.png){width=960}\n:::\n:::\n\n\n:::\n\n::: {.footer}\nEasystats\n:::\n\n## {performance} package II {.smaller}\n\n::: {.panel-tabset}\n\n### Simple\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.237).\n```\n:::\n\n```{.r .cell-code}\ncheck_model(m1, check = c(\"qq\", \"ncv\"))\n```\n\n::: {.cell-output-display}\n![](linear-regression_files/figure-revealjs/check-1-1.png){width=960}\n:::\n:::\n\n\n### Multiple\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.947).\n```\n:::\n\n```{.r .cell-code}\ncheck_model(m2, check = c(\"qq\", \"ncv\"))\n```\n\n::: {.cell-output-display}\n![](linear-regression_files/figure-revealjs/check-2-1.png){width=960}\n:::\n:::\n\n\n:::\n\n::: {.footer}\nEasystats\n:::\n\n\n# Next: Logistic regression analysis",
    "supporting": [
      "linear-regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n<script type=\"ojs-define\">\r\n{\"contents\":[{\"name\":\"data\",\"value\":{\"age\":[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],\"utterance_length\":[4.77,4.648,5.2308,5.5666,6.4007,6.1298,7.1822,8.0834,8.7248,9.0725,9.8019,9.9445,10.2055,11.0279,11.4842],\"fit\":[4.2525,4.7714,5.2903,5.8092,6.3281,6.847,7.3659,7.8848,8.4038,8.9227,9.4416,9.9605,10.4794,10.9983,11.5172],\"pages_read\":[20.3617,9.9097,11.4171,12.2631,10.588,10.6582,15.7444,13.1491,13.958,20.0699,14.571,21.6503,20.3444,14.4721,19.1882],\"fit2\":[4.5001,4.6971,5.2467,5.7768,6.2326,6.7399,7.395,7.8237,8.3527,9.0382,9.3812,10.0951,10.5618,10.8938,11.5381]}}]}\r\n</script>\r\n<script type=\"ojs-define\">\r\n{\"contents\":[{\"name\":\"surface_fit\",\"value\":[[4.1919,4.6971,5.2022,5.7074,6.2126,6.7178,7.223,7.7281,8.2333,8.7385,9.2437,9.7489,10.254,10.7592,11.2644],[4.2119,4.7171,5.2222,5.7274,6.2326,6.7378,7.243,7.7481,8.2533,8.7585,9.2637,9.7689,10.274,10.7792,11.2844],[4.214,4.7191,5.2243,5.7295,6.2347,6.7399,7.245,7.7502,8.2554,8.7606,9.2658,9.7709,10.2761,10.7813,11.2865],[4.2363,4.7415,5.2467,5.7519,6.2571,6.7622,7.2674,7.7726,8.2778,8.783,9.2881,9.7933,10.2985,10.8037,11.3089],[4.2613,4.7665,5.2716,5.7768,6.282,6.7872,7.2924,7.7975,8.3027,8.8079,9.3131,9.8183,10.3234,10.8286,11.3338],[4.2874,4.7926,5.2978,5.803,6.3081,6.8133,7.3185,7.8237,8.3289,8.834,9.3392,9.8444,10.3496,10.8548,11.3599],[4.3113,4.8165,5.3216,5.8268,6.332,6.8372,7.3424,7.8475,8.3527,8.8579,9.3631,9.8683,10.3734,10.8786,11.3838],[4.3264,4.8316,5.3368,5.842,6.3472,6.8523,7.3575,7.8627,8.3679,8.8731,9.3782,9.8834,10.3886,10.8938,11.399],[4.3294,4.8345,5.3397,5.8449,6.3501,6.8553,7.3604,7.8656,8.3708,8.876,9.3812,9.8863,10.3915,10.8967,11.4019],[4.364,4.8691,5.3743,5.8795,6.3847,6.8899,7.395,7.9002,8.4054,8.9106,9.4158,9.9209,10.4261,10.9313,11.4365],[4.4655,4.9707,5.4759,5.9811,6.4863,6.9914,7.4966,8.0018,8.507,9.0122,9.5173,10.0225,10.5277,11.0329,11.5381],[4.4915,4.9967,5.5019,6.0071,6.5123,7.0174,7.5226,8.0278,8.533,9.0382,9.5433,10.0485,10.5537,11.0589,11.5641],[4.4996,5.0048,5.51,6.0152,6.5204,7.0255,7.5307,8.0359,8.5411,9.0463,9.5514,10.0566,10.5618,11.067,11.5722],[4.5001,5.0053,5.5105,6.0157,6.5209,7.026,7.5312,8.0364,8.5416,9.0468,9.5519,10.0571,10.5623,11.0675,11.5727],[4.5381,5.0433,5.5485,6.0537,6.5589,7.064,7.5692,8.0744,8.5796,9.0848,9.5899,10.0951,10.6003,11.1055,11.6107]]}]}\r\n</script>\r\n<script type=\"ojs-define\">\r\n{\"contents\":[{\"name\":\"layout\",\"value\":{\"scene\":{\"xaxis\":{\"title\":\"Age\"},\"yaxis\":{\"title\":\"Pages read\"},\"zaxis\":{\"title\":\"Utterance length\"}},\"margin\":{\"l\":0,\"r\":0,\"t\":0,\"b\":0}}}]}\r\n</script>\r\n"
      ],
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    // dispatch for htmlwidgets\r\n    function fireSlideEnter() {\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n    }\r\n\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n      fireSlideEnter();\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}